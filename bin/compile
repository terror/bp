#!/usr/bin/python3

import os

imports = [
  'argparse',
  'shutil',
  'os',
  're',
  'sys',
  'enum',
  'functools'
]

def x(path):
  with open(path, "r") as file:
    for i, v in enumerate(file.readlines()):
      if "import" not in v:
        return i

def compile(path, target):
  f = open(target, 'w+')
  f.write("#!/usr/bin/python3\n\n")
  for i in imports:
    f.write("import " + i + "\n")
  for root, dirs, files in os.walk(path, topdown=True):
    for file in files:
      if file == '__init__.py':
        continue
      f.write(f'\n# **** {file} ****\n')
      with open(os.path.join(root, file), 'r') as buff:
        for line in buff.readlines()[x(os.path.join(root, file)):]:
          f.write(line)
  f.close()

if __name__ == '__main__':
  compile('src', 'bp.py')
